local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local Player = Players.LocalPlayer
local PlayerGui = Player:WaitForChild("PlayerGui")

local Fun = {}

-- Tạo ScreenGui
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
ScreenGui.Name = "FunNotificationUI"
ScreenGui.Parent = PlayerGui

-- Container để chứa nhiều notify
local Container = Instance.new("Frame")
Container.BackgroundTransparency = 1
Container.Size = UDim2.fromScale(0.3, 1) -- chiếm 30% chiều rộng màn hình
Container.Position = UDim2.new(1, 0, 0, 0) -- nằm bên phải
Container.AnchorPoint = Vector2.new(1, 0)
Container.Parent = ScreenGui

local ListLayout = Instance.new("UIListLayout")
ListLayout.Parent = Container
ListLayout.SortOrder = Enum.SortOrder.LayoutOrder
ListLayout.Padding = UDim.new(0, 10)

function Fun:Notify(config)
    local Message = config.Message or "No message"
    local Description = config.Description or ""
    local IconId = config.Icon or "rbxassetid://104496260455729"
    local Duration = config.Duration or 5

    local Frame = Instance.new("Frame")
    Frame.BorderSizePixel = 0
    Frame.BackgroundColor3 = Color3.fromRGB(36, 36, 36)
    Frame.Size = UDim2.fromScale(1, 0.2) -- cao 20% chiều cao container
    Frame.AutomaticSize = Enum.AutomaticSize.Y -- tự scale theo text nếu dài
    Frame.Parent = Container

    local UICorner = Instance.new("UICorner")
    UICorner.Parent = Frame

    local DurationBar = Instance.new("Frame")
    DurationBar.BorderSizePixel = 0
    DurationBar.BackgroundColor3 = Color3.fromRGB(189, 189, 189)
    DurationBar.Size = UDim2.new(1, -20, 0, 3)
    DurationBar.Position = UDim2.new(0, 10, 1, -6)
    DurationBar.Name = "Duration"
    DurationBar.Parent = Frame

    local Icon = Instance.new("ImageLabel")
    Icon.BorderSizePixel = 0
    Icon.BackgroundColor3 = Color3.fromRGB(72, 72, 72)
    Icon.Image = IconId
    Icon.Size = UDim2.fromScale(0.18, 0.35)
    Icon.Position = UDim2.new(0, 8, 0, 8)
    Icon.Name = "icon"
    Icon.Parent = Frame

    local IconCorner = Instance.new("UICorner")
    IconCorner.CornerRadius = UDim.new(1, 0)
    IconCorner.Parent = Icon

    local MessageLabel = Instance.new("TextLabel")
    MessageLabel.TextWrapped = true
    MessageLabel.BorderSizePixel = 0
    MessageLabel.TextScaled = true
    MessageLabel.BackgroundTransparency = 1
    MessageLabel.Size = UDim2.new(0.7, 0, 0, 22)
    MessageLabel.Text = Message
    MessageLabel.TextColor3 = Color3.fromRGB(219, 219, 219)
    MessageLabel.Name = "Message"
    MessageLabel.Position = UDim2.new(0, 64, 0, 12)
    MessageLabel.Parent = Frame

    local Describe = Instance.new("TextLabel")
    Describe.TextWrapped = true
    Describe.BorderSizePixel = 0
    Describe.TextScaled = true
    Describe.BackgroundTransparency = 1
    Describe.Size = UDim2.new(0.9, 0, 0, 50)
    Describe.Text = Description
    Describe.TextColor3 = Color3.fromRGB(244, 244, 244)
    Describe.Name = "Describe"
    Describe.Position = UDim2.new(0, 8, 0, 44)
    Describe.Parent = Frame

    -- hiệu ứng thanh thời gian
    TweenService:Create(DurationBar, TweenInfo.new(Duration, Enum.EasingStyle.Linear), {
        Size = UDim2.new(0, 0, 0, 3)
    }):Play()

    -- tự ẩn sau Duration
    task.delay(Duration, function()
        TweenService:Create(Frame, TweenInfo.new(0.4), {BackgroundTransparency = 1}):Play()
        for _, obj in ipairs(Frame:GetDescendants()) do
            if obj:IsA("TextLabel") or obj:IsA("ImageLabel") or obj:IsA("Frame") then
                TweenService:Create(obj, TweenInfo.new(0.4), {Transparency = 1}):Play()
            end
        end
        task.wait(0.5)
        Frame:Destroy()
    end)
end

return Fun
